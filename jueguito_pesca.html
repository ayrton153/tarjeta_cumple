<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pesca Interactiva</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #87ceeb;
      text-align: center;
      margin: 0;
      padding: 0;
    }

    h1 {
      margin: 10px 0;
    }

    #game-container {
      position: relative;
      width: 100%;
      max-width: 800px;
      height: 500px;
      margin: 0 auto;
      background: linear-gradient(to top, #1e90ff, #87ceeb);
      border: 4px solid #004080;
      overflow: hidden;
    }

    #fish-container {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .fish {
      position: absolute;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: white;
      font-weight: bold;
      animation: swim linear forwards;
    }

    @keyframes swim {
      from { transform: translateX(-100px); }
      to { transform: translateX(900px); }
    }

    #hook {
      position: absolute;
      width: 4px;
      background-color: black;
      left: 50%;
      top: 0;
      transform: translateX(-50%);
      height: 0;
    }

    #hook-tip {
      width: 12px;
      height: 12px;
      background: red;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 50%;
      display: none;
    }

    #score {
      font-size: 24px;
      font-weight: bold;
      margin: 10px 0;
    }

    #fish-button {
      padding: 10px 20px;
      font-size: 18px;
      background-color: #004080;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    #fish-button:active {
      background-color: #002040;
    }
  </style>
</head>
<body>
  <div style="padding: 5%;">

  <h1>ðŸŽ£ Juego de Pesca</h1>
  <div id="game-container">
    <div id="hook"><div id="hook-tip"></div></div>
    <div id="fish-container"></div>
  </div>
  <div id="score">Puntaje: 0</div>
  <button id="fish-button">ðŸŽ¯ Pescar</button>
  </div>

  <script>
    const fishContainer = document.getElementById("fish-container");
    const hook = document.getElementById("hook");
    const hookTip = document.getElementById("hook-tip");
    const scoreDisplay = document.getElementById("score");
    const fishButton = document.getElementById("fish-button");

    let score = 0;
    let hookActive = false;

    const fishTypes = [
      { name: "Sardina", color: "#5DADE2", size: 30, points: 5, speed: 10 },
      { name: "Trucha", color: "#58D68D", size: 40, points: 10, speed: 8 },
      { name: "Pez Globo", color: "#F4D03F", size: 50, points: 15, speed: 7 },
      { name: "AtÃºn", color: "#AF7AC5", size: 60, points: 20, speed: 6 },
      { name: "TiburÃ³n", color: "#E74C3C", size: 70, points: 30, speed: 5 },
    ];

    setInterval(spawnFish, 1500);

    function spawnFish() {
      const fish = fishTypes[Math.floor(Math.random() * fishTypes.length)];
      const fishElem = document.createElement("div");

      fishElem.classList.add("fish");
      fishElem.style.width = `${fish.size}px`;
      fishElem.style.height = `${fish.size}px`;
      fishElem.style.backgroundColor = fish.color;
      fishElem.style.top = `${Math.random() * 90}%`;
      fishElem.style.animationDuration = `${fish.speed}s`;
      fishElem.dataset.points = fish.points;

      fishContainer.appendChild(fishElem);

      setTimeout(() => {
        if (fishElem.parentNode) fishElem.remove();
      }, fish.speed * 1000);
    }

    function dropHook() {
      if (hookActive) return;
      hookActive = true;

      let height = 0;
      const maxHeight = 450;
      const speed = 10;

      function extend() {
        if (!hookActive) return;

        if (height < maxHeight) {
          height += speed;
          hook.style.height = height + "px";
          hookTip.style.display = "block";
          hookTip.style.top = (height - 5) + "px";

          if (checkCatch()) {
            retractHook();
            return;
          }

          requestAnimationFrame(extend);
        } else {
          retractHook();
        }
      }

      requestAnimationFrame(extend);
    }

    function retractHook() {
      let height = parseInt(hook.style.height);
      const speed = 15;

      function retract() {
        if (height > 0) {
          height -= speed;
          hook.style.height = height + "px";
          hookTip.style.top = (height - 5) + "px";
          requestAnimationFrame(retract);
        } else {
          hook.style.height = "0px";
          hookTip.style.display = "none";
          hookActive = false;
        }
      }

      requestAnimationFrame(retract);
    }

    function checkCatch() {
      const hookRect = hookTip.getBoundingClientRect();
      const fishes = document.querySelectorAll(".fish");

      for (let fish of fishes) {
        const fishRect = fish.getBoundingClientRect();

        const overlap = !(
          hookRect.right < fishRect.left ||
          hookRect.left > fishRect.right ||
          hookRect.bottom < fishRect.top ||
          hookRect.top > fishRect.bottom
        );

        if (overlap) {
          const points = parseInt(fish.dataset.points);
          score += points;
          scoreDisplay.textContent = `Puntaje: ${score}`;
          fish.remove();
          return true;
        }
      }

      return false;
    }

    // Soporte para espacio
    document.addEventListener("keydown", (e) => {
      if (e.key === " ") dropHook();
    });

    // Soporte tÃ¡ctil y clic
    fishButton.addEventListener("click", dropHook);
    document.getElementById("game-container").addEventListener("touchstart", () => dropHook());
    document.getElementById("game-container").addEventListener("click", () => dropHook());
  </script>
</body>
</html>
